!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).AIDebugger={})}(this,function(e){"use strict";function t(e,t,n,s){return new(n||(n=Promise))(function(i,r){function o(e){try{a(s.next(e))}catch(e){r(e)}}function l(e){try{a(s.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,l)}a((s=s.apply(e,t||[])).next())})}"function"==typeof SuppressedError&&SuppressedError;class n{constructor(e,t,n=5e3){this.events=[],this.sessionId=e,this.apiUrl=t,this.flushInterval=n,this.startAutoFlush()}track(e,t){this.events.push({type:e,timestamp:Date.now(),data:t}),console.log(`[AI Debugger] ${e}:`,t)}startAutoFlush(){this.flushTimer=setInterval(()=>{this.flush()},this.flushInterval)}flush(){return t(this,void 0,void 0,function*(){if(0===this.events.length)return;const e=[...this.events];this.events=[];try{yield fetch(`${this.apiUrl}/api/events`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sessionId:this.sessionId,events:e})}),console.log(`[AI Debugger] Flushed ${e.length} events`)}catch(t){console.error("[AI Debugger] Failed to send events:",t),this.events.unshift(...e)}})}destroy(){this.flushTimer&&clearInterval(this.flushTimer),this.flush()}}let s=null;e.destroyDebugger=function(){null==s||s.destroy(),s=null,console.log("[AI Debugger] ❌ Destroyed")},e.initDebugger=function(e){const t=e.sessionId||`session_${Date.now()}_${Math.random().toString(36).slice(2,11)}`;return s=new n(t,e.apiUrl,e.flushInterval),document.addEventListener("click",e=>{var t;const n=e.target;null==s||s.track("click",{tag:n.tagName,id:n.id||null,class:n.className||null,text:(null===(t=n.innerText)||void 0===t?void 0:t.slice(0,50))||null,x:e.clientX,y:e.clientY})}),document.addEventListener("input",e=>{const t=e.target;"password"===t.type||t.dataset.private||null==s||s.track("input",{tag:t.tagName,id:t.id||null,name:t.name||null,type:t.type,value:t.value.slice(0,100)})}),window.addEventListener("error",e=>{var t;null==s||s.track("error",{message:e.message,filename:e.filename,lineno:e.lineno,colno:e.colno,stack:(null===(t=e.error)||void 0===t?void 0:t.stack)||null})}),window.addEventListener("unhandledrejection",e=>{null==s||s.track("error",{message:`Unhandled Promise: ${e.reason}`,promise:!0,reason:String(e.reason)})}),s.track("navigation",{url:window.location.href,referrer:document.referrer,userAgent:navigator.userAgent}),console.log(`[AI Debugger] ✅ Initialized with session: ${t}`),t}});
